<link rel="import" href="/bower_components/core-ajax/core-ajax.html">
<link rel="import" href="/bower_components/polymer/polymer.html">
<link rel="import" href="/bower_components/font-roboto/roboto.html">



<polymer-element name="weather-widget" attributes="websocketMessage">
	<template>
	<link rel="stylesheet" href="weather-widget.css">
	<link rel="stylesheet" href="/bower_components/weather-icons/css/weather-icons.min.css">

	<!--<core-ajax id="ajaxtemp" auto url="/api/temp" handleAs="json" response="{{ajaxMessage}}"></core-ajax>-->
	<!--<core-ajax id="ajaxsunset" auto url="/api/sun/set" handleAs="json" response="{{ajaxMessage}}"></core-ajax>-->


	<div id="container">
		<!--Väder-->
		<!--<i class="wi wi-day-lightning" style="font-size:20px;"></i>-->
		<!--<span id="temp"></span>-->

		<div class="windsun small dimmed" style="display: block;">
			<span class="wi wi-strong-wind xdimmed"></span> 1
			<span class="wi wi-sunrise xdimmed"></span> <span id="sunrise"></span>
			<span class="wi wi-sunset xdimmed"></span> <span id="sunset"></span>
		</div>
		<div class="temp" style="display: block;">
			<span class="icon dimmed wi wi-showers"></span><span id="temp"></span>°
		</div>
		<div class="forecast small dimmed" style="display: block;">
			<table class="forecast-table">
				<tbody>
					<tr style="opacity: 1;">
						<td class="day">Fri</td><td class="icon-small wi-night-clear"></td><td class="temp-max">15.8</td><td class="temp-min">12.6</td>
					</tr>
					<tr style="opacity: 0.845;">
						<td class="day">Sat</td><td class="icon-small wi-night-cloudy"></td><td class="temp-max">16.3</td><td class="temp-min">11.5</td>
					</tr>
					<tr style="opacity: 0.69;">
						<td class="day">Sun</td><td class="icon-small wi-night-cloudy"></td><td class="temp-max">16.8</td><td class="temp-min">10</td>
					</tr>
					<tr style="opacity: 0.5349999999999999;">
						<td class="day">Mon</td><td class="icon-small wi-night-cloudy"></td><td class="temp-max">14</td><td class="temp-min">7.2</td>
					</tr>
					<tr style="opacity: 0.3799999999999999;"><td class="day">Tue</td><td class="icon-small wi-night-cloudy"></td><td class="temp-max">18.2</td><td class="temp-min">11.9</td>
					</tr>
					<tr style="opacity: 0.2249999999999999;"><td class="day">Wed</td><td class="icon-small wi-night-clear"></td><td class="temp-max">11</td><td class="temp-min">11</td></tr>
				</tbody>
			</table>
		</div>

	</div>

  </template>
  <script>

  (function() {

	Polymer('weather-widget', {
		selected: 0,
		showmenu: 0,
		page:0,
		websocketMessage:{},
		ready: function(){
			//this.refreshAjax();
		},
		refreshAjax: function(){
			this.$.ajaxtemp.go();
			this.$.ajaxsunset.go();
			this.async(this.refreshAjax,null,900000); //refresh every 15 minutes.
		},
		toggleMenu: function() {
			console.log("toggleMenu");
			if(this.showmenu === 1){
					this.showmenu = 0;
					return;
				}
			this.showmenu = 1;
			console.log(this.showmenu);
		},
		websocketMessageChanged: function(){
			switch(this.websocketMessage.type){
				case 'temp':
					this.$.temp.innerHTML=this.websocketMessage.data;
					break;
				case 'sunset':
					this.$.sunset.innerHTML=this.websocketMessage.data;
					break;
				case 'sunrise':
					this.$.sunrise.innerHTML=this.websocketMessage.data;
					break;
				case 'left':
					this.page--;
					break;
				case 'right':
					this.page++
					break;
			}
		},
	});

})();
</script>
</polymer-element>
